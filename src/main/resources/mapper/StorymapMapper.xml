<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.nju.userstorymappingtool.dao.StorymapMapper">
  <resultMap id="BaseResultMap" type="cn.edu.nju.userstorymappingtool.entity.Storymap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="mapid" jdbcType="BIGINT" property="mapid" />
    <result column="userid" jdbcType="BIGINT" property="userid" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="createdtime" jdbcType="BIGINT" property="createdtime" />
    <result column="isdeleted" jdbcType="SMALLINT" property="isdeleted" />
    <result column="deletedtime" jdbcType="BIGINT" property="deletedtime" />
    <result column="modifiedtime" jdbcType="BIGINT" property="modifiedtime" />
    <result column="releasenum" jdbcType="INTEGER" property="releasenum" />
    <result column="storynum" jdbcType="INTEGER" property="storynum" />
    <result column="description" jdbcType="VARCHAR" property="description" />
    <result column="ongoingstorynum" jdbcType="INTEGER" property="ongoingstorynum" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from storymap
    where mapid = #{mapid,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="cn.edu.nju.userstorymappingtool.entity.Storymap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="mapid" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into storymap (userid, `name`, createdtime, 
      isdeleted, deletedtime, modifiedtime, 
      releasenum, storynum, description, 
      ongoingstorynum)
    values (#{userid,jdbcType=BIGINT}, #{name,jdbcType=VARCHAR}, #{createdtime,jdbcType=BIGINT}, 
      #{isdeleted,jdbcType=SMALLINT}, #{deletedtime,jdbcType=BIGINT}, #{modifiedtime,jdbcType=BIGINT}, 
      #{releasenum,jdbcType=INTEGER}, #{storynum,jdbcType=INTEGER}, #{description,jdbcType=VARCHAR}, 
      #{ongoingstorynum,jdbcType=INTEGER})
  </insert>
  <update id="updateByPrimaryKey" parameterType="cn.edu.nju.userstorymappingtool.entity.Storymap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update storymap
    set userid = #{userid,jdbcType=BIGINT},
      `name` = #{name,jdbcType=VARCHAR},
      createdtime = #{createdtime,jdbcType=BIGINT},
      isdeleted = #{isdeleted,jdbcType=SMALLINT},
      deletedtime = #{deletedtime,jdbcType=BIGINT},
      modifiedtime = #{modifiedtime,jdbcType=BIGINT},
      releasenum = #{releasenum,jdbcType=INTEGER},
      storynum = #{storynum,jdbcType=INTEGER},
      description = #{description,jdbcType=VARCHAR},
      ongoingstorynum = #{ongoingstorynum,jdbcType=INTEGER}
    where mapid = #{mapid,jdbcType=BIGINT}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select mapid, userid, `name`, createdtime, isdeleted, deletedtime, modifiedtime, 
    releasenum, storynum, description, ongoingstorynum
    from storymap
    where mapid = #{mapid,jdbcType=BIGINT}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select mapid, userid, `name`, createdtime, isdeleted, deletedtime, modifiedtime, 
    releasenum, storynum, description, ongoingstorynum
    from storymap
  </select>
  <select id="selectAllMapsByUserid" parameterType="java.lang.Long" resultType="cn.edu.nju.userstorymappingtool.entity.Storymap">
     <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
   select mapid, userid, `name`, createdtime, isdeleted, deletedtime, modifiedtime,
   releasenum, storynum, description, ongoingstorynum
   from storymap where userid = #{userid,jdbcType=BIGINT} and isdeleted = 0
   </select>
   
  <select id="findStoryMap" parameterType="java.lang.Long" resultType="java.lang.String">
      select code
      from mapcode where userid= #{userid,jdbcType=BIGINT} and {mapid,jdbcType=BIGINT}
  </select>
  
  <insert id="saveStoryMap" parameterType="cn.edu.nju.userstorymappingtool.entity.MapCode">
      insert into mapcode(userid,mapid,code)
      values(#{userid,jdbcType=BIGINT},#{mapid,jdbcType=BIGINT},#{code,jdbcType=TEXT})
  </insert>
  
  <update id="updateStoryMap" parameterType="cn.edu.nju.userstorymappingtool.entity.MapCode">
      update mapcode
      set code = #{code,jdbcType=TEXT}
      where userid = #{userid,jdbcType=BIGINT} and mapid = #{mapid,jdbcType=BIGINT}
  </update>
</mapper>